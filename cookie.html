<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
  />
    <meta charset="utf-8">
    <title></title>
    <style media="screen">
    body{margin: 0;height: 100vh}
      img{width:70%;}
      .container{
        display:flex;
        height: 100vh;
      }
      .item1{
          flex-grow:1;
          background-image: url("海.jpg");}
      .item2{
          flex-grow:1;
          background-color: pink;}
      .item3{
          flex-grow:1;
          background-color: yellow;}

          #buildings_sell{
            display:none;
          }
    </style>
  </head>
  <body>
    <script type="text/javascript">

    let event_ids=[];

    class Building{
      constructor(time,num,cost){
        this.interval_ids=[];
        this.interval_time=time;
        this.add_num=num;
        this.cost=cost;
      }
      count_up(num){
        count+=num;
      }
      buy(){
        if(count>=this.cost){
          count-=this.cost;
        let self=this;
        let return_id=setInterval(function(){
          self.count_up(self.add_num);
        },self.interval_time);
        this.interval_ids.push(return_id);
      }
    }
      sell(){
        let return_id=this.interval_ids.pop();
        clearInterval(return_id);
      }
    }

    let tataki=new Building(10000,1,10);
    let sasimi=new Building(1000,1,50);
    let tuna=new Building(1000,8,100);



      count=0;
      let ls_count=localStorage.getItem("ls_count");
      if(ls_count){
        count=parseInt(ls_count);
        count=0;
    }else{
      count=0;
    }

    setInterval(hozon,1000);
    function hozon() {
      localStorage.setItem("ls_count",count);

    }
      tataki_count=0;
      sasimi_count=0;
      tuna_count=0;

      setInterval(screen_update,10);
      function screen_update() {
      span = document.getElementById('cookie_count');
      span.textContent=count;
    }

      function cookie_click() {
        var cookie_img=document.getElementById('cookie_clickimg');
        cookie_img.classList.remove('animate__animated','animate__shakeX');
        void cookie_img.offsetWidth;
        cookie_img.classList.add('animate__animated','animate__shakeX');
        var cookie_img=document.getElementById('cookie_clickimg2');
        cookie_img.classList.remove('animate__animated','animate__shakeX');
        void cookie_img.offsetWidth;
        cookie_img.classList.add('animate__animated','animate__shakeX');
        span=document.getElementById('cookie_count');
        count++;
        span.textContent=count;
      }
      /* function tataki() {
        if(count>=0){
          count+=1;
          tataki_count++;
      let r_id = setInterval(auto_CountUp,1500,1);
      event_ids.push(r_id);
       }
     }

      function sell_tataki(){
        let r_id=event_ids.pop();
        clearInterval(r_id);

      }

        function sasimi() {
          if(count>=0){
            count+=10;
            sasimi_count++;
          setInterval(auto_CountUp,1000,1);
         }
        }
        function tuna() {
          if(count>=0){
            count+=30;
            tuna_count++;
          setInterval(auto_CountUp,500,1);
         }
        }
*/
        function auto_CountUp(num) {
          count += num;
          var cookie_img=document.getElementById('cookie_clickimg');
          cookie_img.classList.remove('animate__animated','animate__shakeX');
          void cookie_img.offsetWidth;
          cookie_img.classList.add('animate__animated','animate__shakeX');
          var cookie_img=document.getElementById('cookie_clickimg2');
          cookie_img.classList.remove('animate__animated','animate__shakeX');
          void cookie_img.offsetWidth;
          cookie_img.classList.add('animate__animated','animate__shakeX');
          span=document.getElementById('cookie_count');
            }

            function buildSwitch(){
            let buy_element=document.getElementById('buildings_buy');
            let sell_element=document.getElementById('buildings_sell');
            if(buy_element.style.display !="none"){
              buy_element.style.display="none";
              sell_element.style.display="block";
            }else{
              buy_element.style.display="block";
              sell_element.style.display="none";
            }
            }

    </script>
    <div class="container">

    <div class="item1">
      <p class="animate__animated animate__bounce">
        まぐろの消費量:<span id="cookie_count"></span>匹
      </p>
      <img id="cookie_clickimg" onclick="cookie_click()" src="マグロ.jpg" alt="">
      <img id="cookie_clickimg2" onclick="cookie_click()" src="マグロ.jpg" alt="">
    </div>
    <div class="item2">
      制作途中
    </div>
    <div class="item3">
      <div id="buildings_buy">

    <span onclick="buildSwitch()"> 購入</span>
      <ul>
        <li onclick="tataki.buy()">まぐろたたき</li>
        <li onclick="sasimi.buy()">刺身</li>
        <li onclick="tuna.buy()">ツナ</li>
      </ul>
    </div>
        <div id="buildings_sell">
    <span onclick="buildSwitch()"> 売却</span>
      <ul>
        <li onclick="tataki.sell()">まぐろたたき</li>
        <li onclick="sasimi.sell()">刺身</li>
        <li onclick="tuna.sell()">ツナ</li>
      </ul>
    </div>

    </div>
  </body>
</html>
